# План разработки Frontend для Dvorfs Repository Manager

Настоящий план основан на документах `SOW.md` и `api-doc.json` и описывает этапы создания frontend-приложения.

---

### **0. Подготовительный этап: Настройка проекта**

1.  **Инициализация проекта:**
    *   Создать новое приложение на `Next.js` с поддержкой `TypeScript`.
    *   Интегрировать `Tailwind CSS` для стилизации.
    *   Добавить `AnimeJS` для анимаций.

2.  **Структура проекта:**
    *   Определить базовую архитектуру:
        *   `pages/`: Роутинг и страницы приложения.
        *   `components/`: Переиспользуемые UI-компоненты (кнопки, инпуты, модальные окна).
        *   `lib/` или `services/`: Логика взаимодействия с API, управление состоянием.
        *   `hooks/`: Пользовательские хуки React.
        *   `styles/`: Глобальные стили.
        *   `utils/`: Вспомогательные функции.

3.  **Настройка API клиента:**
    *   Создать централизованный API-клиент (например, на базе `axios` или `fetch`) для взаимодействия с backend.
    *   Реализовать обработку JWT токенов для аутентификации и автоматическое добавление их в заголовки запросов.
    *   Настроить обработку ошибок API.

4.  **Линтинг и форматирование:**
    *   Настроить `ESLint` и `Prettier` для поддержания единого стиля кода.

---

### **Список экранов (UI Screens)**

Ниже представлен полный список экранов, которые необходимо реализовать в рамках frontend-приложения.

1.  **Аутентификация:**
    *   `Страница входа (Login)`: Форма для ввода имени пользователя и пароля.

2.  **Основной интерфейс (Layout):**
    *   `Главный экран с навигацией`: Включает в себя шапку (Header) с информацией о пользователе и выходом, а также боковую панель навигации (Sidebar) для доступа ко всем разделам.

3.  **Репозитории (Repositories):**
    *   `Список репозиториев`: Таблица или сетка со всеми созданными репозиториями, с возможностью фильтрации и поиска.
    *   `Просмотр содержимого репозитория`: Древовидная структура или список файлов и папок внутри репозитория с возможностью загрузки/скачивания артефактов.

4.  **Поиск (Search):**
    *   `Страница поиска артефактов`: Поле для ввода поискового запроса и отображение списка найденных артефактов с информацией о них.

5.  **Администрирование (Administration / Settings):**
    *   **Репозитории (Repositories):**
        *   `Создание/Редактирование репозитория`: Форма для создания и изменения репозиториев всех типов (`hosted`, `proxy`, `group`) с соответствующими полями.
    *   **Безопасность (Security):**
        *   `Список пользователей`: Таблица со всеми пользователями системы.
        *   `Создание/Редактирование пользователя`: Форма для управления данными пользователя и назначения ролей.
        *   `Список ролей`: Таблица со всеми ролями.
        *   `Создание/Редактирование роли`: Форма для управления ролями и их привилегиями.
    *   **Хранилища (Storage):**
        *   `Список Blob Stores`: Таблица со всеми хранилищами бинарных данных.
        *   `Создание/Редактирование Blob Store`: Форма для настройки хранилищ.
    *   **Политики очистки (Cleanup Policies):**
        *   `Список политик очистки`: Таблица со всеми политиками.
        *   `Создание/Редактирование политики очистки`: Форма для настройки правил автоматической очистки артефактов.

---

### **Этап 1: MVP (Minimum Viable Product) (~3-4 недели)**

**Цель:** Реализовать базовый функционал для аутентификации, управления `hosted` репозиториями и артефактами.

| Задача | Описание | Используемые API эндпоинты |
| :--- | :--- | :--- |
| **1. Аутентификация** | - Создать страницу входа (`/login`).<br>- Реализовать форму входа и выхода из системы.<br>- Создать механизм защищенных роутов (protected routes).<br>- Управлять состоянием сессии пользователя (например, через React Context). | `POST /auth/login`<br>`POST /auth/logout`<br>`GET /auth/me` |
| **2. Управление репозиториями (базовое)** | - Создать страницу для отображения списка всех репозиториев.<br>- Реализовать UI для создания `hosted` репозиториев (`RAW`, `Maven`).<br>- Отображать основную информацию о репозиториях в виде таблицы или карточек. | `GET /repositories`<br>`POST /repositories`<br>`GET /repositories/{name}` |
| **3. Управление артефактами (базовое)** | - Создать страницу для просмотра содержимого репозитория.<br>- Реализовать функционал загрузки артефактов через UI.<br>- Обеспечить возможность скачивания артефактов. | `PUT /repository/{repository-name}/{path}`<br>`GET /repository/{repository-name}/{path}` |
| **4. Базовый UI/UX** | - Разработать основной макет приложения: шапка, боковая панель навигации, контентная область.<br>- Создать базовый набор UI-компонентов (кнопки, поля ввода, таблицы). | - |

---

### **Этап 2: Расширение функциональности (~4-6 недель)**

**Цель:** Добавить поддержку `proxy` и `group` репозиториев, а также реализовать управление пользователями и ролями (RBAC).

| Задача | Описание | Используемые API эндпоинты |
| :--- | :--- | :--- |
| **1. Управление репозиториями (расширенное)** | - Расширить форму создания/редактирования для поддержки типов `proxy` и `group`.<br>- Добавить поля для настройки удаленного URL для `proxy` репозиториев.<br>- Реализовать UI для выбора репозиториев при создании `group`. | `PUT /repositories/{name}`<br>`DELETE /repositories/{name}` |
| **2. Управление пользователями (RBAC)** | - Создать раздел "Security" в UI.<br>- Реализовать страницы для просмотра, создания, редактирования и удаления пользователей. | `GET /security/users`<br>`POST /security/users`<br>`PUT /security/users/{username}`<br>`DELETE /security/users/{username}`<br>`PUT /security/users/{username}/password` |
| **3. Управление ролями (RBAC)** | - Создать страницу для управления ролями.<br>- Реализовать UI для создания и назначения привилегий ролям. | `GET /security/roles`<br>`POST /security/roles`<br>`PUT /security/roles/{roleId}`<br>`DELETE /security/roles/{roleId}` |
| **4. Поиск артефактов** | - Создать отдельную страницу поиска.<br>- Реализовать поисковую строку и отображение результатов поиска артефактов по всем репозиториям. | `GET /search/artifacts` |

---

### **Этап 3: Стабилизация и Production-готовность (~6-8 недель)**

**Цель:** Добавить оставшийся функционал, провести оптимизацию и подготовить систему к промышленной эксплуатации.

| Задача | Описание | Используемые API эндпоинты |
| :--- | :--- | :--- |
| **1. Политики очистки (Cleanup Policies)** | - Создать UI для управления политиками очистки.<br>- Реализовать создание, редактирование и удаление политик.<br>- Привязать политики к репозиториям в UI. | `GET /cleanup-policies`<br>`POST /cleanup-policies`<br>`PUT /cleanup-policies/{policyId}`<br>`DELETE /cleanup-policies/{policyId}` |
| **2. Управление Blob Stores** | - Создать UI для просмотра и управления Blob Stores.<br>- Реализовать CRUD операции для Blob Stores. | `GET /blob-stores`<br>`POST /blob-stores`<br>`GET /blob-stores/{id}`<br>`PUT /blob-stores/{id}`<br>`DELETE /blob-stores/{id}` |
| **3. Поддержка всех форматов** | - Убедиться, что UI корректно обрабатывает и отображает все заявленные форматы (`NPM`, `Pypi`, `APT`, `RPM`, `Docker`).<br>- Добавить специфические иконки или метаданные для разных форматов. | - |
| **4. Оптимизация и UX** | - Провести аудит производительности: оптимизировать загрузку страниц и рендеринг больших списков.<br>- Улучшить UX: добавить анимации, индикаторы загрузки, уведомления.<br>- Обеспечить адаптивность интерфейса для разных разрешений экрана. | - |
| **5. Документация** | - Интегрировать или добавить ссылку на Swagger/OpenAPI документацию.<br>- Написать руководства пользователя для основных функций в UI. | - |
